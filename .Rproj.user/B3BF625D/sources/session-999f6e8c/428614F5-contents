activity_times <- function(df) {
  unique_cages <- unique(df$Cage)
  results <- list()

  for (cage in unique_cages) {
    cage_data <- df %>%
      filter(Cage == cage)

    unique_dates <- unique(cage_data$Date)

    for (date in unique_dates) {
      daily_data <- cage_data %>%
        filter(Date == date)

      if (nrow(daily_data) > 0) {
        metrics <- find_offset(daily_data)
        results[[paste(cage, date, sep = "_")]] <- metrics
      }
    }
  }

  combined_data <- bind_rows(results)
  return(combined_data)
}
